## MySQL_Lock

### 一. 乐观锁
> 指操作数据库时(更新操作)，想法很乐观，认为这次的操作不会导致冲突，在操作数据时，并不进行任何其他的特殊处理（也就是不加锁），而在进行更新后，再去判断是否有冲突了（事后补救锁）

* 实现思路：在表中的数据进行操作时(更新)，先给数据表加一个版本(version)字段，每操作一次，将那条记录的版本号加1。先查询出那条记录，获取出version字段,如果要对那条记录进行操作(更新),则先判断此刻version的值是否与刚刚查询出来时的version的值相等

### 二. 悲观锁
> 与乐观锁相对,在操作数据时，认为此操作会出现数据冲突，所以在进行每次操作时都要通过获取锁才能进行对相同数据的操作

* 实现思路：悲观锁是由数据库自己实现了的，要用的时候，我们直接调用数据库的相关语句就可以了

##### 2.1 悲观锁_共享锁（读锁）
> 对于多个不同的事务，对同一个资源共享同一个锁；相当于对于同一把门，它拥有多个钥匙一样

* 使用：在执行语句后面加上lock in share mode就代表对某些资源加上共享锁
* 如 SELECT * from city where id = "1"  lock in share mode;
* 其他用户可以并发读取数据

##### 2.2 悲观锁_排它锁(写锁)
> 对于多个不同的事务，对同一个资源只能有一把锁。
与共享锁类型，在需要执行的语句后面加上for update就可以了
> 获准排他锁的事务既能读数据，又能修改数据

##### 2.3 其他概念
 1. 行锁：给某一行加上锁，也就是一条记录加上锁
 2. 表锁：和行锁相对应，给这个表加上锁
 
### 三. 死锁
* 互斥竞争
* 请求保持
* 不可剥夺
* 循环等待
